# AIRI AI Providers Setup Guide

Этот документ описывает настройку новых AI-провайдеров для AIRI: Silero TTS, Tauri Whisper и KoboldCPP Whisper.

## Что было реализовано

### 1. Новые провайдеры

#### Silero TTS (Синтез речи)
- **Описание**: Локальный сервер Silero TTS для качественного синтеза речи на русском и английском языках
- **Поддерживаемые голоса**: Aidar, Baya, Kseniya, Xenia (русский), EN_0-2 (английский)
- **Настройки**: URL сервера, выбор голоса, частота дискретизации
- **Плейграунд**: Тестирование синтеза речи с воспроизведением

#### Tauri Whisper (Транскрипция речи)
- **Описание**: Локальная транскрипция через Tauri с использованием Whisper
- **Модели**: Tiny (39MB), Base (74MB), Small (244MB), Medium (769MB), Large (1550MB)
- **Поддерживаемые языки**: Автоопределение, русский, английский и др.
- **Возможности**: Загрузка моделей, запись с микрофона, загрузка аудиофайлов

#### KoboldCPP Whisper (Транскрипция речи)
- **Описание**: Транскрипция через API сервера KoboldCPP
- **Возможности**: Запись с микрофона, загрузка файлов, тест соединения
- **Поддерживаемые языки**: Автоопределение, русский, английский и др.

### 2. Интеграция с существующими модулями

#### Модуль Speech (Синтез речи)
- Добавлена поддержка Silero TTS
- Специальная обработка для Silero провайдера
- Настройки голоса и частоты дискретизации

#### Модуль Hearing (Распознавание речи)
- Добавлена поддержка Tauri Whisper и KoboldCPP Whisper
- Запись аудио с микрофона
- Загрузка и обработка аудиофайлов
- Управление моделями Whisper

### 3. Пользовательский интерфейс

#### Страницы настроек
- `/settings/providers/silero-tts` - настройки Silero TTS
- `/settings/providers/tauri-whisper` - настройки Tauri Whisper
- `/settings/providers/koboldcpp-whisper` - настройки KoboldCPP Whisper

#### Возможности
- Настройка URL серверов
- Выбор моделей и голосов
- Загрузка моделей Whisper
- Тестирование провайдеров через плейграунды
- Полная локализация на русском и английском

## Как использовать

### Настройка Silero TTS

1. Запустите сервер Silero TTS:
   ```bash
   # Установите и запустите Silero TTS сервер
   # Обычно доступен на http://localhost:8001
   ```

2. Перейдите в **Настройки → Провайдеры → Silero TTS**

3. Настройте:
   - **URL сервера**: `http://localhost:8001/`
   - **Голос**: Выберите подходящий голос (Aidar, Baya и др.)
   - **Частота дискретизации**: 48000 Hz (рекомендуется)

4. Протестируйте в плейграунде

### Настройка Tauri Whisper

1. Убедитесь, что вы используете приложение AIRI через Tauri (desktop версия)

2. Перейдите в **Настройки → Провайдеры → Tauri Whisper**

3. Настройте:
   - **Модель**: Medium (рекомендуется для баланса скорости/точности)
   - **Язык**: Русский или автоопределение

4. Нажмите **"Загрузить модель"** (процесс может занять время)

5. Протестируйте запись или загрузку аудио

### Настройка KoboldCPP Whisper

1. Запустите KoboldCPP с поддержкой Whisper:
   ```bash
   # Убедитесь что KoboldCPP запущен с Whisper
   # Обычно доступен на http://localhost:5001
   ```

2. Перейдите в **Настройки → Провайдеры → KoboldCPP Whisper**

3. Настройте:
   - **URL сервера**: `http://localhost:5001/`
   - **Язык**: Русский или автоопределение

4. Нажмите **"Проверить соединение"**

5. Протестируйте в плейграунде

## Активация провайдеров

### Для синтеза речи
1. Перейдите в **Настройки → Модули → Speech**
2. Выберите **Silero TTS** как провайдер
3. Настройте голос и параметры

### Для распознавания речи
1. Перейдите в **Настройки → Модули → Hearing**
2. Выберите **Tauri Whisper** или **KoboldCPP Whisper**
3. Настройте модель и язык

## Технические детали

### Файловая структура
```
packages/stage-ui/src/
├── bindings/
│   ├── silero-tts.ts          # API для Silero TTS
│   ├── tauri-whisper.ts       # Tauri биндинги для Whisper
│   └── koboldcpp-whisper.ts   # API для KoboldCPP Whisper
├── stores/
│   ├── providers.ts           # Регистрация новых провайдеров
│   └── modules/
│       ├── speech.ts          # Обновленный модуль речи
│       └── hearing.ts         # Обновленный модуль слуха

apps/stage-web/src/pages/settings/providers/
├── silero-tts.vue            # Настройки Silero TTS
├── tauri-whisper.vue         # Настройки Tauri Whisper
└── koboldcpp-whisper.vue     # Настройки KoboldCPP Whisper

packages/i18n/src/locales/
├── en/settings.yaml          # Английская локализация
└── ru/settings.yaml          # Русская локализация
```

### API эндпоинты

#### Silero TTS
- `GET /tts/speakers` - список доступных голосов
- `POST /tts/generate` - генерация речи
- `GET /health` - проверка состояния

#### Tauri Whisper
- `load_ort_model_whisper` - загрузка модели
- `ipc_audio_transcription` - транскрипция аудио

#### KoboldCPP Whisper
- `POST /v1/audio/transcriptions` - основной API
- `POST /api/extra/transcribe` - альтернативный API
- `GET /api/v1/model` - информация о модели

## Устранение неисправностей

### Silero TTS
- **Ошибка соединения**: Проверьте, что сервер запущен на правильном порту
- **Нет голосов**: Убедитесь, что эндпоинт `/tts/speakers` доступен
- **Плохое качество**: Попробуйте изменить частоту дискретизации

### Tauri Whisper
- **Модель не загружается**: Проверьте доступность интернета и место на диске
- **Транскрипция не работает**: Убедитесь, что модель загружена
- **Нет доступа к микрофону**: Предоставьте разрешения браузеру/приложению

### KoboldCPP Whisper
- **Ошибка соединения**: Проверьте URL и статус сервера KoboldCPP
- **API не отвечает**: Убедитесь, что KoboldCPP запущен с поддержкой Whisper
- **Медленная транскрипция**: Проверьте загрузку сервера

## Заключение

Новые AI-провайдеры полностью интегрированы в AIRI и готовы к использованию. Все компоненты имеют полную локализацию, обработку ошибок и интуитивно понятный интерфейс для настройки и тестирования.
