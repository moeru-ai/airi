# 快速开始

<cite>
**本文档引用的文件**  
- [package.json](file://package.json)
- [pnpm-workspace.yaml](file://pnpm-workspace.yaml)
- [turbo.json](file://turbo.json)
- [README.md](file://README.md)
- [learning/快速启动.md](file://learning/快速启动.md)
</cite>

## 目录
1. [简介](#简介)
2. [开发环境准备](#开发环境准备)
3. [项目依赖安装](#项目依赖安装)
4. [启动Web应用](#启动web应用)
5. [启动Electron桌面应用](#启动electron桌面应用)
6. [Monorepo工作区与构建缓存](#monorepo工作区与构建缓存)
7. [常见问题解决方案](#常见问题解决方案)
8. [总结](#总结)

## 简介

本指南旨在帮助新用户和开发者在10分钟内快速设置开发环境并成功运行项目。我们将详细介绍如何安装pnpm、安装项目依赖、启动Web应用和Electron桌面应用。此外，我们还将解释monorepo工作区和构建缓存的基本概念，并提供常见问题的解决方案。

## 开发环境准备

在开始之前，请确保您的系统满足以下前置要求：

- **Node.js**：推荐使用Node.js 23或更高版本。
- **pnpm**：项目使用pnpm@10.18.2作为包管理器。您可以通过以下命令全局安装：
  ```powershell
  npm i -g pnpm@10.18.2
  ```
- **Rust**（可选）：如果您需要构建Rust crates，则需要安装rustup和cargo。

**Section sources**
- [learning/快速启动.md](file://learning/快速启动.md#L4-L10)

## 项目依赖安装

在项目根目录下运行以下命令来安装所有工作区依赖：

```powershell
pnpm install
```

此命令将安装所有工作区的依赖项，并执行`postinstall`钩子（如果存在）。

**Section sources**
- [learning/快速启动.md](file://learning/快速启动.md#L13-L17)

## 启动Web应用

要启动Web应用（浏览器版本），请在项目根目录下运行以下命令：

```powershell
pnpm dev
```

或者使用更具体的命令：

```powershell
pnpm run dev:web
```

这将启动Stage Web应用，您可以在浏览器中访问它。

**Section sources**
- [README.md](file://README.md#L140-L146)
- [learning/快速启动.md](file://learning/快速启动.md#L20-L24)

## 启动Electron桌面应用

要启动Electron桌面应用（Tamagotchi），请在项目根目录下运行以下命令：

```powershell
pnpm dev:tamagotchi
```

这将启动Stage Tamagotchi桌面应用。

**Section sources**
- [README.md](file://README.md#L158)
- [learning/快速启动.md](file://learning/快速启动.md#L39)

## Monorepo工作区与构建缓存

### Monorepo工作区

本项目采用monorepo架构，使用`pnpm-workspace.yaml`文件定义工作区包。该文件指定了哪些目录包含可链接的包：

```yaml
packages:
  - packages/**
  - plugins/**
  - services/**
  - examples/**
  - docs/**
  - apps/**
  - '!**/dist/**'
```

这种结构允许我们在多个包之间共享代码和依赖，同时保持项目的模块化。

### 构建缓存

项目使用TurboRepo进行高速构建和缓存。`turbo.json`文件配置了构建任务：

```json
{
  "$schema": "https://turborepo.com/schema.json",
  "tasks": {
    "build": {
      "outputs": ["dist/**"]
    }
  }
}
```

TurboRepo通过缓存任务输出来加速重复构建，显著提高开发效率。

**Section sources**
- [pnpm-workspace.yaml](file://pnpm-workspace.yaml#L1-L10)
- [turbo.json](file://turbo.json#L1-L8)

## 常见问题解决方案

### 依赖安装失败

- **检查pnpm版本**：确保您使用的是正确的pnpm版本（10.18.2）。
- **网络问题**：确认网络连接正常，必要时使用代理。
- **清理缓存**：尝试清理pnpm缓存并重新安装：
  ```powershell
  pnpm store prune
  ```
  或删除`node_modules`和`pnpm-lock.yaml`后重新运行`pnpm install`。

### 构建错误

- **端口冲突**：检查是否有其他进程占用了所需端口，并停止这些进程。
- **Rust构建失败**：确保已安装正确的toolchain：
  ```powershell
  rustup default stable
  ```
  然后运行`cargo build --workspace`查看详细错误信息。

**Section sources**
- [learning/快速启动.md](file://learning/快速启动.md#L84-L90)

## 总结

通过本指南，您应该能够在短时间内成功设置开发环境并运行项目。记住使用正确的命令启动Web应用和Electron桌面应用，并利用monorepo和构建缓存的优势来提高开发效率。如果遇到问题，请参考常见问题解决方案部分。