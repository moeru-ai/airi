# 技术栈与依赖

<cite>
**本文档中引用的文件**  
- [README.md](file://README.md)
- [package.json](file://package.json)
- [turbo.json](file://turbo.json)
- [apps/stage-web/package.json](file://apps/stage-web/package.json)
- [apps/stage-tamagotchi/package.json](file://apps/stage-tamagotchi/package.json)
- [packages/drizzle-duckdb-wasm/README.md](file://packages/drizzle-duckdb-wasm/README.md)
- [packages/duckdb-wasm/README.md](file://packages/duckdb-wasm/README.md)
- [crates/tauri-plugin-mcp/README.md](file://crates/tauri-plugin-mcp/README.md)
</cite>

## 目录
1. [简介](#简介)
2. [前端框架](#前端框架)
3. [样式系统](#样式系统)
4. [桌面应用框架](#桌面应用框架)
5. [音频处理库](#音频处理库)
6. [LLM集成](#llm集成)
7. [3D渲染](#3d渲染)
8. [数据库](#数据库)
9. [构建工具](#构建工具)

## 简介
本项目旨在构建一个基于大型语言模型（LLM）的虚拟角色，支持在浏览器和桌面环境中运行。项目采用现代化的Web技术栈，并结合AI能力实现语音识别、自然语言处理、3D模型控制等功能。技术选型兼顾性能、可扩展性和跨平台兼容性，确保在不同设备上提供一致的用户体验。

**Section sources**
- [README.md](file://README.md#L1-L360)

## 前端框架

### Vue 3
Vue 3 是本项目的核心前端框架，提供了响应式数据绑定、组件化开发和高效的虚拟DOM渲染机制。项目中的多个应用（如 `stage-web` 和 `stage-tamagotchi`）均基于 Vue 3 构建，利用其 Composition API 实现复杂状态逻辑的封装与复用。

### Pinia
Pinia 作为 Vue 官方推荐的状态管理库，用于管理全局状态，如用户设置、AI模型配置、对话历史等。其轻量级设计和直观的API使得状态管理更加清晰和可维护。

### Vite
Vite 作为构建工具和开发服务器，显著提升了开发体验。它利用浏览器原生ES模块支持，实现极快的冷启动和热模块替换（HMR），特别适合大型单页应用的开发。

**Section sources**
- [apps/stage-web/package.json](file://apps/stage-web/package.json#L50-L51)
- [apps/stage-tamagotchi/package.json](file://apps/stage-tamagotchi/package.json#L100-L101)

## 样式系统

### UnoCSS
UnoCSS 是一个原子化CSS引擎，允许开发者通过类名直接编写CSS规则，支持按需生成样式，极大减少了CSS文件体积。项目中通过 `unocss` 及其相关插件（如 `@unocss/preset-mini`、`unocss-preset-scrollbar`）实现高度定制化的UI样式，并集成字体、图标等资源。

**Section sources**
- [package.json](file://package.json#L50-L51)
- [apps/stage-web/package.json](file://apps/stage-web/package.json#L100-L101)

## 桌面应用框架

### Electron
Electron 用于构建 `stage-tamagotchi` 桌面应用，允许使用Web技术（HTML、CSS、JavaScript）开发跨平台桌面应用。项目通过 `electron-vite` 集成Vite，优化了开发流程，并利用 `electron-builder` 进行打包发布。

### Tauri
Tauri 被用于部分原生功能的扩展，如通过 `tauri-plugin-mcp` 插件与MCP服务器交互。Tauri 提供更轻量的运行时，结合Rust后端，增强了应用的安全性和性能。

**Section sources**
- [apps/stage-tamagotchi/package.json](file://apps/stage-tamagotchi/package.json#L80-L81)
- [crates/tauri-plugin-mcp/README.md](file://crates/tauri-plugin-mcp/README.md#L1-L105)

## 音频处理库

### Web Audio API
Web Audio API 用于实现浏览器端的音频输入处理、实时语音检测和音频流控制。项目通过 `@ricky0123/vad-web` 实现语音活动检测（VAD），结合 `onnxruntime-web` 在客户端运行语音识别模型。

### onnxruntime-web
onnxruntime-web 使得在浏览器中运行ONNX格式的机器学习模型成为可能。项目利用它在客户端执行语音识别（如Whisper模型），保护用户隐私并降低服务器负载。

**Section sources**
- [apps/stage-web/package.json](file://apps/stage-web/package.json#L70-L71)
- [apps/stage-tamagotchi/package.json](file://apps/stage-tamagotchi/package.json#L120-L121)

## LLM集成

### xsAI SDK
xsAI 是项目的核心LLM集成框架，支持多种AI服务提供商，包括 OpenAI、Anthropic Claude、Google Gemini、Ollama、vLLM 等。通过 `@xsai/generate-text`、`@xsai/stream-text` 等模块，实现文本生成、流式响应、语音合成等功能，为虚拟角色提供智能对话能力。

**Section sources**
- [README.md](file://README.md#L250-L300)
- [apps/stage-web/package.json](file://apps/stage-web/package.json#L60-L65)

## 3D渲染

### Three.js
Three.js 用于实现3D场景渲染，支持VRM和Live2D模型的加载与动画控制。项目通过 `three` 和 `@types/three` 实现3D模型的骨骼动画、材质渲染和交互控制。

### TresJS
TresJS 是 Three.js 的 Vue 3 组件库，允许以声明式方式编写3D场景。项目使用 `@tresjs/core` 和 `@tresjs/cientos` 实现与Vue生态的无缝集成，简化3D组件的开发与状态管理。

**Section sources**
- [apps/stage-web/package.json](file://apps/stage-web/package.json#L90-L91)
- [apps/stage-tamagotchi/package.json](file://apps/stage-tamagotchi/package.json#L140-L141)

## 数据库

### Drizzle ORM
Drizzle ORM 作为类型安全的数据库查询构建器，用于管理应用的本地和远程数据。项目结合 `drizzle-orm` 和 `drizzle-kit` 实现数据库模式迁移和类型生成。

### DuckDB WASM
DuckDB WASM 是一个嵌入式SQL数据库，可在浏览器中运行。项目通过 `@proj-airi/drizzle-duckdb-wasm` 实现纯浏览器端的数据库支持，适用于本地数据存储和分析场景。

**Section sources**
- [packages/drizzle-duckdb-wasm/README.md](file://packages/drizzle-duckdb-wasm/README.md#L1-L4)
- [apps/stage-web/package.json](file://apps/stage-web/package.json#L40-L41)

## 构建工具

### Turbo
Turbo 是一个高性能的构建系统，用于管理多包项目的依赖和任务执行。项目通过 `turbo.json` 配置构建、测试和 lint 任务，利用缓存机制加速开发流程。

### pnpm
pnpm 作为包管理器，通过硬链接和符号链接优化依赖存储，减少磁盘占用并提升安装速度。项目使用 `pnpm` 管理工作区（workspace）中的多个包，并通过 `pnpm` 脚本统一执行开发命令。

**Section sources**
- [turbo.json](file://turbo.json#L1-L9)
- [package.json](file://package.json#L10-L11)